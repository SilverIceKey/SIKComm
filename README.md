# SIKComm 2.x（Serial & SocketCAN）
**统一通信层 · 半双工友好 · 轻量易用**

SIKComm 2.x 是一个专注于 **串口（232/485/USB-Serial）** 与 **SocketCAN** 的轻量级通信框架。  
目标是提供一个 **稳定、简单、易接入** 的通信层，只解决三件事：

1. **连接设备**（串口 / CAN）
2. **发送指令、接收数据**
3. **把原始字节流解析成业务能用的结构**

---

## ✨ 特点

- **仅支持两类通道：SerialPort + SocketCAN**  
  干净、聚焦，不做多余协议。

- **强制串行化收发（半双工友好）**  
  虽然串口理论上全双工，但大量工业设备（尤其 RS485/RS232）属于半双工或接近半双工。  
  2.x 对每个设备采用“**单队列串行调度**”，确保收发不会互相抢占。

- **单向设备友好**  
  对于如扫码头等“只收不发”或“偶尔发”的设备，框架原生支持，不需要额外处理。

- **统一消息输入 / 输出模型**  
  框架统一处理底层收发，业务只需提供“如何解析字节流”即可。

- **无插件系统、无自动注入、无复杂扩展机制**  
  只保留通信层最必要的能力，保证可控、可维护、易接入。

---

## 📦 支持的通道类型

### SerialPort（RS232 / RS485 / USB-Serial）
- 半双工队列模式
- 设备路径、波特率、校验等基本参数
- 支持“仅接收”模式
- 设备可持续读取数据并推送给解析逻辑

### SocketCAN
- 支持标准 CAN & CAN FD（取决于系统支持）
- 可选的基础 ID 过滤
- 与串口统一的收发模式

---

## 🧱 基本流程

业务侧只需要三步：

1. **初始化设备配置**
    - 串口参数 / CAN 参数
    - 是否单向
    - 是否自动连接等

2. **打开设备连接**
    - 框架负责底层建立通道与状态管理

3. **发送请求或接收数据**
    - 请求/响应自动串行化
    - 持续接收的数据交给业务的解析逻辑处理

框架内部负责：

- 底层通道的打开和关闭
- 强制串行执行请求
- 从设备持续读取原始字节流
- 提交数据给业务端解析

---

## 🔧 数据解析（由业务提供）

业务只需提供一段逻辑，用来把底层收到的字节流转成业务结构，例如：

- 起始位、结束位
- 帧头 / 帧尾
- 长度字段
- CRC 校验
- 分包 / 拆包（粘包处理）

框架不限制格式，保持最大自由度。

---

## ⚠️ 破坏性升级说明

### **2.0.0 = 全面重写版**

- 与 1.x **完全不兼容**
- 移除 BLE、TCP、Mock
- 移除所有插件与自动注入体系
- API 全部重写，只保留通信所需能力
- 配置格式完全不同
- 推荐视为全新框架使用

---

## 📜 License 切换说明

- **1.0.16 及之前版本：MIT License**
- **自 1.0.17 起：改为 Apache License 2.0**

> 本 README 对应版本：**SIKComm 2.x 系列起始版本**

---

## 📌 适用场景

- RS485 半双工设备
- 串口传感器、下位机控制
- 工业 CAN 总线（SocketCAN）
- 扫码头（只收不发）
- 强依赖串行化收发的设备通信

